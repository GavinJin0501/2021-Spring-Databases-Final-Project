<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>B-Airline</title>
        <link rel="stylesheet" href="../static/public_view.css" />
        <script src="../static/lib/moment.js"></script>
    </head>


    <body>
        <nav class="navbar">
            <div class="navbar__container">
              {% if session["logged_in"] == True%}
                    <a href="/SearchFlight" id="navbar__logo">B-AIR for {{session["type"]}}</a>
                    <div class="navbar__toggle" id="mobile-menu">
                        <span class="bar"></span> <span class="bar"></span>
                        <span class="bar"></span>
                    </div>
                {% else %}
                    <a href="/SearchFlight" id="navbar__logo">B-AIR</a>
                    <div class="navbar__toggle" id="mobile-menu">
                        <span class="bar"></span> <span class="bar"></span>
                        <span class="bar"></span>
                    </div>
                {% endif%}
              <ul class="navbar__menu">
                <li class="navbar__item">
                  <a href="/SearchFlight" class="navbar__links" id="links">Search Flight</a>
                </li>
                <li class="navbar__item">
                  <a href="/CheckStatus" class="navbar__links" id="links">Check Status</a>

                  {% if session["logged_in"] == True%}
                    {% if session.get("type", "guest") == "customer" %}
                      <li class="navbar__item">
                        <a href="/ViewMyFlights" class="navbar__links" id="links">View My Flights</a>
                      </li>
                    {% endif %}
                        <li class="navbar__btn">
                        <a href="/logout" class="button" id="logout">Logout</a>
                        </li>
                    {% else %}
                        <li class="navbar__btn">
                        <a href="/login" class="button" id="login">Login</a>
                        </li>
                        <li class="navbar__btn">
                            <a href="/register" class="button" id="sign-up">Register</a>
                        </li>
                    {% endif%}

              </ul>
            </div>
        </nav>


        <div class="search-container" id="search-container">
            <form action="/CheckStatus" onsubmit="return formValidation()" autocomplete="off" method="POST">
                <label id="navbar__logo">Welcome! </br> You may check flight status here!</label> </br>
                <label class="label">Flight Number</label>             
                <input type="text" name = "flight_num" placeholder="flight number" required/> </br>
<!--                <datalist id="flight-number">-->
<!--                    {% for line in flight_number %}-->
<!--                        <option value="{{line}}">-->
<!--                    {% endfor %}-->
<!--                </datalist>-->
                <label class="label">Departure Date</label>
                <input type="date" name = "departure_date" placeholder="date" id = "date"/>
                <label class="label">Arrival Date</label>
                <input type="date" name = "arrival_date" placeholder="date" id = "date"/> </br>
                <input type="submit" value = Search>
            </form>
        </div>

        {% if status_result %}
            <div class="topbutton">
                <div class="statusbar-container">
                    Airline / flight
                </div>
                <div class="statusbar-container">
                    Date / depart time
                </div>
                <div class="statusbar-container">
                    Status
                </div>
                <!-- <div class="bar-container">
                    Plane number
                </div>
                <div class="bar-container">
                    buy
                </div> -->
            </div>
        {% endif%}

    <form>
        {% for line in status_result %}
            <section class="button">
                <div class="bluebutton">
                    <section class="bluebutton">
                        <div class="status-button-container1">
                            <div class="otherlabel">{{line[0]}}</div>
                        </br>
                            <div class="otherlabel">{{line[1]}}</div>
                        </div>
                        <div class="status-button-container">
                            <section class="otherlabel">{{line[4]}}</section>
                        </div>
                        <div class="status-button-container1">
                            {% if line[2] == 'Upcoming' %}
                                <section class="upcominglabel">{{line[2]}}</section>
                            {% elif line[2] == 'In-progress' %}
                                <section class="inprogresslabel">{{line[2]}}</section>
                            {% elif line[2] == 'Delayed' %}
                                <section class="delayedlabel">{{line[2]}}</section>
                            {% elif line[2] == 'Canceled' %}
                                <section class="canceledlabel">{{line[2]}}</section>
                            {% endif%}
                        </div> 
                    </section>
                </div>
            </section>
        {% endfor%}






    </body>
    <script type="text/javascript">
        var flights_status = {{status_result | safe}}, date_format = 'YYYY-MM-DD';

        function formValidation() {
            const re = /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
            var form_departure_date, form_arrival_date;

            form_departure_date = document.getElementsByName("departure_date")[0].value;
            form_arrival_date = document.getElementsByName("arrival_date")[0].value;

            if ((!form_departure_date) && (!form_arrival_date)) {
                alert("At least one of departure/arrival date should be filled!");
                return false;
            }

            if (form_departure_date && (!moment(form_departure_date, date_format, true).isValid())) {
                alert("Departure date is not valid. Support format: 'YYYY-MM-DD'");
                return false;
            }

            if (form_arrival_date && (!moment(form_departure_date, date_format, true).isValid())) {
                alert("Arrival date is not valid. Support format: 'YYYY-MM-DD'");
                return false;
            }

            return true;

        }

        

    </script>
</html>
